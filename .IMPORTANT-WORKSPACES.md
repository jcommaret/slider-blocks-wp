# âš ï¸ IMPORTANT - NPM Workspaces

## ğŸš« Ce qu'il NE FAUT JAMAIS faire

### âŒ Ne JAMAIS crÃ©er ces fichiers dans les workspaces

```
src/button-with-arrow/
â”œâ”€â”€ âŒ package-lock.json    # INTERDIT - un seul Ã  la racine
â”œâ”€â”€ âŒ node_modules/        # INTERDIT - gÃ©rÃ© par le workspace racine
â””â”€â”€ âŒ yarn.lock            # INTERDIT - utiliser NPM uniquement

src/main-bloc/
â”œâ”€â”€ âŒ package-lock.json    # INTERDIT
â”œâ”€â”€ âŒ node_modules/        # INTERDIT
â””â”€â”€ âŒ yarn.lock            # INTERDIT

src/slider/
â”œâ”€â”€ âŒ package-lock.json    # INTERDIT
â”œâ”€â”€ âŒ node_modules/        # INTERDIT
â””â”€â”€ âŒ yarn.lock            # INTERDIT
```

### âŒ Ne JAMAIS exÃ©cuter ces commandes dans les workspaces

```bash
# âŒ MAUVAIS - Ne PAS faire Ã§a dans src/button-with-arrow/, src/main-bloc/, etc.
cd src/button-with-arrow
npm install              # âŒ NON !
npm update               # âŒ NON !
npm ci                   # âŒ NON !
```

---

## âœ… Ce qu'il FAUT faire

### âœ… Structure correcte avec NPM Workspaces

```
slider-blocks-wp/                    (ROOT)
â”œâ”€â”€ âœ… package.json                  # Configuration principale
â”œâ”€â”€ âœ… package-lock.json             # UN SEUL lock file ici
â”œâ”€â”€ âœ… node_modules/                 # TOUTES les dÃ©pendances ici
â”‚
â””â”€â”€ src/
    â”œâ”€â”€ button-with-arrow/
    â”‚   â”œâ”€â”€ âœ… package.json          # MÃ©tadonnÃ©es uniquement
    â”‚   â”œâ”€â”€ âœ… edit.js
    â”‚   â””â”€â”€ âœ… save.js
    â”‚
    â”œâ”€â”€ main-bloc/
    â”‚   â””â”€â”€ âœ… package.json          # MÃ©tadonnÃ©es uniquement
    â”‚
    â””â”€â”€ slider/
        â””â”€â”€ âœ… package.json          # MÃ©tadonnÃ©es uniquement
```

### âœ… Commandes Ã  exÃ©cuter DEPUIS LA RACINE

```bash
# âœ… BON - Toujours depuis la racine du projet
cd /chemin/vers/slider-blocks-wp

npm install                          # âœ… Installe TOUT
npm run build:all                    # âœ… Build tous les workspaces
npm run start:all                    # âœ… Dev tous les workspaces

# Pour un workspace spÃ©cifique
npm run build --workspace=slider     # âœ… OK
npm run start --workspace=slider     # âœ… OK
```

---

## ğŸ” Comment vÃ©rifier que tout est correct

### VÃ©rification rapide

```bash
# Doit afficher UNIQUEMENT les workspaces, pas de node_modules dedans
ls -la src/button-with-arrow/
ls -la src/main-bloc/
ls -la src/slider/

# Doit afficher les 3 workspaces
npm ls --workspaces --depth=0
```

### Sortie attendue

```
citeo-blocks@0.1.0
â”œâ”€â”€ button-with-arrow@0.1.0 -> ./src/button-with-arrow
â”œâ”€â”€ main-bloc@0.1.0 -> ./src/main-bloc
â””â”€â”€ slider@0.1.0 -> ./src/slider
```

---

## ğŸ§¹ Nettoyer les fichiers obsolÃ¨tes

Si vous trouvez des fichiers interdits, supprimez-les :

```bash
# Supprimer les package-lock.json des workspaces
rm -f src/*/package-lock.json

# Supprimer les node_modules des workspaces
rm -rf src/*/node_modules

# RÃ©installer proprement
npm run reinstall
```

---

## ğŸ“š Pourquoi ces rÃ¨gles ?

### Avec NPM Workspaces

- **Un seul point d'entrÃ©e** : Tout se gÃ¨re depuis la racine
- **Hoisting automatique** : Les dÃ©pendances communes sont remontÃ©es
- **CohÃ©rence garantie** : MÃªmes versions partout
- **Performance** : Installation plus rapide

### Si vous crÃ©ez des lock files dans les workspaces

- âŒ Conflits de versions possibles
- âŒ Duplication des dÃ©pendances
- âŒ IncohÃ©rences entre composants
- âŒ Builds qui peuvent Ã©chouer de maniÃ¨re alÃ©atoire

---

## ğŸ’¡ RÃ©sumÃ©

| Action | OÃ¹ l'exÃ©cuter | Statut |
|--------|---------------|--------|
| `npm install` | **Racine uniquement** | âœ… |
| `npm run build:all` | **Racine uniquement** | âœ… |
| `npm run start --workspace=X` | **Racine uniquement** | âœ… |
| `cd src/slider && npm install` | Workspace | âŒ INTERDIT |
| `package-lock.json` dans workspace | Workspace | âŒ INTERDIT |
| `node_modules/` dans workspace | Workspace | âŒ INTERDIT |

---

**ğŸ¯ RÃ¨gle d'or : Avec NPM Workspaces, TOUT se fait depuis la racine !**
